---
phase: 04-polish
plan: 04
type: execute
wave: 3
depends_on:
  - 04-polish-01
  - 04-polish-02
  - 04-polish-03
files_modified:
  - web/package.json
  - web/components.json
  - web/app/layout.tsx
  - web/app/globals.css
  - web/app/dashboard/page.tsx
  - web/components/theme-provider.tsx
  - web/components/theme-toggle.tsx
  - web/components/app-sidebar.tsx
  - web/components/dashboard/overview-cards.tsx
  - web/components/dashboard/progress-chart.tsx
  - web/components/dashboard/tasks-table.tsx
autonomous: true
requirements: []
user_setup: []

must_haves:
  truths:
    - "User can run a web dashboard surface from this repo and see a working dashboard shell"
    - "User can switch between light and dark themes, and the chosen theme persists"
    - "Dashboard charts and table remain readable in both themes with no low-contrast token regressions"
    - "Dashboard async states show explicit loading, empty, and error UI instead of blank/frozen regions"
  artifacts:
    - path: "web/app/layout.tsx"
      provides: "Root layout with next-themes provider and hydration-safe setup"
    - path: "web/app/globals.css"
      provides: "Light/dark design tokens plus paired chart tokens"
    - path: "web/app/dashboard/page.tsx"
      provides: "Dashboard shell composition with sidebar/cards/chart/table and async state branches"
    - path: "web/components/theme-provider.tsx"
      provides: "Reusable ThemeProvider wrapper configured for class-based themes"
    - path: "web/components/theme-toggle.tsx"
      provides: "UI control for explicit light/dark switching"
  key_links:
    - from: "web/app/layout.tsx"
      to: "web/components/theme-provider.tsx"
      via: "ThemeProvider wraps app body"
      pattern: "ThemeProvider"
    - from: "web/app/dashboard/page.tsx"
      to: "web/app/globals.css"
      via: "dashboard chart/table colors use CSS variables"
      pattern: "var\(--chart-|var\(--color-"
    - from: "web/app/dashboard/page.tsx"
      to: "web/components/dashboard/progress-chart.tsx"
      via: "dashboard composes chart component with state-driven data"
      pattern: "<ProgressChart"
---

<objective>
Add a shadcn-based web dashboard surface to Phase 4 polish with required dual-theme support (light + dark) and explicit UX states.

Purpose: Extend polish from terminal-only UX into a modern web dashboard without hand-rolled UI infrastructure.
Output: Web dashboard baseline using shadcn patterns, next-themes wiring, and readable dark/light tokenized visuals.
</objective>

<execution_context>
@/Users/tommy/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/tommy/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-polish/04-RESEARCH.md
@.planning/phases/04-polish/04-02-SUMMARY.md
@internal/view/study.go
</context>

<tasks>

<task type="auto">
  <name>Bootstrap web dashboard workspace with shadcn shell primitives</name>
  <files>web/package.json, web/components.json, web/app/layout.tsx, web/app/dashboard/page.tsx, web/components/app-sidebar.tsx</files>
  <action>
    Create a dedicated `web/` Next.js App Router workspace and initialize shadcn UI in that workspace (not the Go root), then scaffold dashboard shell composition using the documented shadcn dashboard pattern (`SidebarProvider`, inset content, card regions).
    Install and configure only the standard stack from research (`shadcn/ui`, `tailwindcss`, `next-themes`, `recharts`, `@tanstack/react-table`) and avoid hand-built layout primitives because they increase drift and maintenance risk.
    Keep data inputs mocked via typed interfaces at this stage so shell composition and UX-state contracts can be verified before service wiring.
  </action>
  <verify>
    <automated>npm --prefix web run lint && npm --prefix web run build</automated>
  </verify>
  <done>Web dashboard route renders a shadcn-composed shell from this repository with no framework/config errors.</done>
</task>

<task type="auto">
  <name>Implement required dark + light theme architecture and switcher</name>
  <files>web/components/theme-provider.tsx, web/components/theme-toggle.tsx, web/app/layout.tsx, web/app/globals.css</files>
  <action>
    Wire `next-themes` exactly with class-based theming and hydration-safe layout (`suppressHydrationWarning` on root html), then expose an explicit theme toggle control in dashboard chrome.
    Define paired light and dark tokens in `globals.css`, including `--chart-*` variables for both themes, and ensure chart/table components read tokens rather than hard-coded color values.
    Do not defer dark mode to a follow-up task; shipping both themes together is required to avoid late-stage token drift.
  </action>
  <verify>
    <automated>npm --prefix web run lint && npm --prefix web run build</automated>
  </verify>
  <done>Theme toggle switches between light and dark modes, preference persists, and chart colors remain legible in both themes.</done>
</task>

<task type="auto">
  <name>Add dashboard data modules with loading/empty/error polish states</name>
  <files>web/app/dashboard/page.tsx, web/components/dashboard/overview-cards.tsx, web/components/dashboard/progress-chart.tsx, web/components/dashboard/tasks-table.tsx</files>
  <action>
    Implement typed dashboard modules (overview cards, progress chart, tasks table) using shadcn components and Recharts/TanStack composition patterns from research docs.
    In `dashboard/page.tsx`, add explicit state branches for loading, empty, and error and ensure each module renders deterministic fallback UI instead of blank placeholders.
    Mirror the Phase 4 polish semantics already used in TUI (`idle/loading/success/warning/error`) at the web boundary so user feedback remains consistent across surfaces.
  </action>
  <verify>
    <automated>npm --prefix web run lint && npm --prefix web run build</automated>
  </verify>
  <done>Dashboard modules render with explicit async-state UX and remain readable/usable in both light and dark themes.</done>
</task>

</tasks>

<verification>
- `npm --prefix web run lint` passes
- `npm --prefix web run build` passes
- Manual smoke: run web app, open dashboard, toggle light/dark, confirm chart/table readability and loading/empty/error states
</verification>

<success_criteria>
- [ ] Web dashboard is runnable from repository with shadcn dashboard shell
- [ ] Light and dark themes are both implemented and user-switchable
- [ ] Chart/table visual tokens are defined and legible in both themes
- [ ] Loading/empty/error states are explicit for dashboard modules
</success_criteria>

<output>
After completion, create `.planning/phases/04-polish/04-04-SUMMARY.md`
</output>
