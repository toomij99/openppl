---
phase: 01-foundation
plan: 02
type: execute
wave: 2
depends_on:
  - 01-foundation-01
files_modified:
  - internal/model/model.go
  - internal/services/planner.go
  - internal/tui.go
  - internal/view/study.go
  - internal/view/progress.go
autonomous: true
requirements:
  - PLAN-01
  - PLAN-02
  - PLAN-03
  - PLAN-04
  - PLAN-05
  - PROG-01
  - PROG-02
  - PROG-03
user_setup: []
must_haves:
  truths:
    - "User can enter checkride date and see backward-scheduled study plan"
    - "Daily tasks organized in 4 categories: Theory, Chair Flying, Garmin 430, CFI Flights"
    - "User can mark tasks complete and see progress percentage update"
    - "Progress persists across app restarts"
  artifacts:
    - path: "internal/services/planner.go"
      provides: "Backward scheduling algorithm"
    - path: "internal/view/study.go"
      provides: "Study plan view with task list"
    - path: "internal/view/progress.go"
      provides: "Progress tracking view"
  key_links:
    - from: "study.go"
      to: "planner.go"
      via: "GenerateStudyPlan()"
    - from: "progress.go"
      to: "model.go"
      via: "CalculateProgress()"
---

<objective>
Implement backward scheduling from checkride date, daily task views with 4 categories, and progress tracking with completion percentage.

Purpose: Core value proposition — systematic daily study planning. User enters checkride date, app generates backward-scheduled tasks.
Output: User can enter checkride date, view daily tasks, mark complete, see progress %.
</objective>

<execution_context>
@/Users/tommy/.config/opencode/get-shit-done/workflows/execute-plan.md
</execution_context>

<context>
@.planning/research/ARCHITECTURE.md
@.planning/research/SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Implement backward scheduling algorithm</name>
  <files>internal/services/planner.go</files>
  <action>
    Create internal/services/planner.go:
    - GenerateStudyPlan(checkrideDate time.Time, totalDays int) []DailyTask
    - DistributeTasksByCategory(tasks []DailyTask, categories []string) map[string][]DailyTask
    
    Hardcode ACS Area breakdown from FAA-S-ACS-6C (16 Areas). 
    Categories: "Theory" (knowledge), "Chair Flying" (oral prep), "Garmin 430" (nav), "CFI Flights" (flight ops).
    
    Generate ~60-90 days of tasks before checkride. Distribute ACS elements across available days.
    Return []DailyTask with Date, Category, Title, Description populated.
  </action>
  <verify>
    <automated>go build -o ppl-tui .</automated>
  </verify>
  <done>Backward scheduler produces tasks distributed across days</done>
</task>

<task type="auto">
  <name>Create Study Plan view</name>
  <files>internal/view/study.go, internal/tui.go</files>
  <action>
    Create internal/view/study.go with StudyView struct:
    - TextInput for entering checkride date (MM/DD/YYYY format)
    - List of daily tasks grouped by week
    - Filter by category buttons (All, Theory, Chair Flying, Garmin 430, CFI Flights)
    - Enter key selects task to toggle completion
    
    Update MainModel to include StudyView. Wire up keyboard handlers:
    - Arrow keys navigate task list
    - Enter toggles selected task complete
    - Tab cycles category filters
    - / triggers checkride date entry
    
    Display "No study plan" prompt if checkride date not set.
  </action>
  <verify>
    <automated>go build -o ppl-tui .</automated>
  </verify>
  <done>User can enter date, see task list, filter by category, toggle completion</done>
</task>

<task type="auto">
  <name>Implement Progress tracking</name>
  <files>internal/view/progress.go, internal/model/model.go</files>
  <action>
    Create ProgressView in internal/view/progress.go:
    - Overall progress bar (completed tasks / total tasks * 100)
    - Progress by category (4 progress bars)
    - Today's tasks with completion status
    - Recent completions list (last 7 days)
    
    Add methods to model.go:
    - CalculateProgress() returns (completed, total, percentage)
    - GetProgressByCategory() returns map[string]ProgressStats
    - MarkTaskComplete(taskID uint) updates Progress table
    
    Wire into MainModel. Display percentage as integer with lipgloss progress bar.
  </action>
  <verify>
    <automated>go build -o ppl-tui .</automated>
  </verify>
  <done>Progress view shows completion %, updates when tasks marked complete</done>
</task>

</tasks>

<verification>
- User can enter checkride date via UI
- Tasks generate backward from checkride date
- Tasks organized in 4 categories
- Marking task complete updates progress percentage
- Progress persists across app restarts (SQLite)
</verification>

<success_criteria>
- [ ] User enters checkride date → tasks generate backward
- [ ] Daily view shows 4 categories with tasks
- [ ] Arrow keys navigate, Enter toggles completion
- [ ] Progress % updates immediately on completion
- [ ] Data persists in SQLite
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/02-study-progress-SUMMARY.md`
</output>
